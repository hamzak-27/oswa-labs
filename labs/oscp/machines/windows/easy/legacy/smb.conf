# SMB Configuration for Legacy Machine (MS17-010 Vulnerable)
# Simulates Windows 7 SMB service vulnerable to EternalBlue

[global]
    # Basic server information
    workgroup = WORKGROUP
    server string = Legacy Windows 7 Machine
    netbios name = LEGACY
    
    # Security settings (vulnerable configuration)
    security = user
    map to guest = bad user
    guest account = guest
    
    # SMB protocol versions (vulnerable to MS17-010)
    server min protocol = NT1
    client min protocol = NT1
    client max protocol = SMB3
    
    # Logging
    log file = /var/log/samba/log.%m
    max log size = 1000
    log level = 2
    
    # Network settings
    interfaces = lo eth0
    bind interfaces only = yes
    
    # Disable some security features to simulate vulnerable Windows 7
    client signing = disabled
    server signing = disabled
    
    # Legacy authentication methods
    lanman auth = yes
    ntlm auth = yes
    
    # File system settings
    unix extensions = no
    wide links = yes
    follow symlinks = yes
    
# Share configurations
[C$]
    comment = Default Administrative Share
    path = /
    browseable = no
    writable = yes
    guest ok = no
    valid users = root, john
    admin users = root

[ADMIN$]
    comment = Remote Admin Share
    path = /opt/legacy
    browseable = no  
    writable = yes
    guest ok = no
    admin users = root

[IPC$]
    comment = Remote IPC Share
    path = /tmp
    browseable = no
    writable = no
    guest ok = yes

[Users]
    comment = User Directories
    path = /home
    browseable = yes
    writable = yes
    guest ok = yes
    read only = no
    create mask = 0644
    directory mask = 0755

[Public]
    comment = Public Share
    path = /tmp/public
    browseable = yes
    writable = yes
    guest ok = yes
    public = yes
    read only = no